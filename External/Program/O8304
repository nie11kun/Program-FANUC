%
O8304(TI XING) 

G52 W0 V0
(SEND PARAMETER)
#512=#868 (DRESSER BIG SPEED)
#514=#870(AMOUNT OF FEED,BIG)
#513=#869 (DRESSER SMALL SPEED)
#515=#871 (AMOUNT OF FEED,SMALL)
#510=#853(DRESS TIMES)
#537=#850 (NEW WHEEL FLAG)
#527=#859 (CURRENT WHEEL DIA.)
IF [#537 EQ 0] THEN #527=#852 (NEW WHEEL DIA.)
#524=#860 (WHEEL LINE SPEED M/S)
#521=#866 (NEW WHEEL V)

(DRESS PROGRAMM)
#592=#512
#506=30
#507=1

#801=#526
#802=#822
#803=#823
#808=#824

#814=#517-#802/2
#819=#517+#802/2

IF [#512 LE 0] THEN #512=100
IF [#513 LE 0] THEN #513=50
IF [#537 EQ 0] GOTO 50
#522=#857
#527=#859
GOTO 100

N50
#538=#803+TAN[#506]*[#801-[#803*[TAN[#813]+TAN[#817]]+#802]]/2
#522=#521+#538
#523=#852+2*#538

N100
G90 G94 G64 G01 V[#522+1] F[3*#512]
W#517
V[#522+1]

#511=0
#535=0
#532=0

(DRESS CYCLES)
N500
#592=#512
#594=#514
IF [#511 LT [#853-1]] GOTO 600
#592=#513
#594=#515

N600
IF [#511 GT #853] GOTO 5000

#522=#522-#594

(DRESS RIGHT)
#800=#810
#804=#811
#805=#813
#806=#812

#540=#802/2
#541=#540+[#800+#804]*COS[#805]
#542=-[#800+#804]*[1-SIN[#805]]

IF [#800 LT #806] GOTO 620
#544=-#800+#800*SIN[#805]-#803
#543=ABS[#542-#544]*TAN[#805]+#541
#548=#801/2+#507+#800*SIN[#805]
#549=#544-[#548-#543]*TAN[#805]
GOTO 650

N620
#543=#541+[#803-[#804+#806]*[1-SIN[#805]]]*TAN[#805]
#544=[#806-#800]*[1-SIN[#805]]-#803
#545=#543+[#806-#800]*COS[#805]
#546=-#803
#547=#545+#800*TAN[#506/2]
#548=#801/2+#507+#800*SIN[#805]
#549=-#803-[#548-#547]*TAN[#506]
N650

G52 W#814 V[#522-#808]
G90 G01 V0 F300
G90 G01 W5 F600
G90 G01 W-#540 V0 F#592
G90 G02 W-#541 V#542 R[#800+#804] F#592
IF [#800 GE #806] GOTO 680
G90 G01 W-#543 V#544 F#592
G90 G03 W-#545 V#546 R[#806-#800] F#592
G90 G01 W-#547 F#592
G90 G01 W-#548 V#549 F#592
GOTO 700

N680
G90 G01 W-#543 V#544 F#592
G90 G01 W-#548 V#549 F#592
N700
G90 G01 V0 F1200
G52 W0 V0

(DRESS LEFT)
#800=#815
#804=#816
#805=#817
#806=#818

#540=#802/2
#541=#540+[#800+#804]*COS[#805]
#542=-[#800+#804]*[1-SIN[#805]]

IF [#800 LT #806] GOTO 720
#544=-#800+#800*SIN[#805]-#803
#543=ABS[#542-#544]*TAN[#805]+#541
#548=#801/2+#507+#800*SIN[#805]
#549=#544-[#548-#543]*TAN[#805]
GOTO 750

N720
#543=#541+[#803-[#804+#806]*[1-SIN[#805]]]*TAN[#805]
#544=[#806-#800]*[1-SIN[#805]]-#803
#545=#543+[#806-#800]*COS[#805]
#546=-#803
#547=#545+#800*TAN[#506/2]
#548=#801/2+#507+#800*SIN[#805]
#549=-#803-[#548-#547]*TAN[#506]
N750

G52 W#819 V#522
G90 G01 V0 F300
G90 G01 W-5 F600
G90 G01 W#540 F#592
G90 G03 W#541 V#542 R[#800+#804] F#592
IF [#800 GE #806] GOTO 780
G90 G01 W#543 V#544 F#592
G90 G03 W#545 V#546 R[#806-#800] F#592
G90 G01 W#547 F#592
G90 G01 W#548 V#549 F#592
GOTO 800

N780
G90 G01 W#543 V#544 F#592
G90 G01 W#548 V#549 F#592

N800
G90 G01 V0 F1200
G52 W0 V0

#523=#523-2*#594
#537=1
#850=#537 (WHEEL FLAG)
#857=#522
IF [#523 LT #527] GOTO 1100
#532=#532+1
GOTO 500

N1100
#527=#523
#535=#535+#594

#780=#780-#594 (CUT X)
#880=#880-#594
#896=#896-#594

#511=#511+1
IF [#511 LT #510] GOTO 500

N5000
G52 W0 V0
G90 G64 G01 V[#522+1] F[3*#512]
M99
%
